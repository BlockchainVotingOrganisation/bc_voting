{namespace bvs=Goettertz\BcVoting\ViewHelpers}

<f:layout name="Default" />

<f:section name="main">
<f:translate key="tx_bcvoting_edit_project" />: Options
<f:render partial="Project/Menu" arguments="{project : project}" />
<h4>{project.name}</h4>
<f:flashMessages renderMode="div" />
<table>
  <tr>
    <th><f:translate key="tx_bcvoting_domain_model_option.name" /></th>
    <th><f:translate key="tx_bcvoting_domain_model_option.wallet_address" /></th>
    <th>&nbsp;</th>
  </tr>
  <f:for each="{options}" as="option">
    <tr>
      <td>{option.name}</td>
      <td><img src="https://chart.googleapis.com/chart?chs=300x300&cht=qr&chl=bitcoin:{option.walletAddress}?amount=1" width="150" height="150" /></td>
      <td>
      {project.assignments.role.name}
      	<f:if condition="{project.assignments.role.name} == 'admin'">
			<f:then>
			<f:link.action action="edit" controller="Option" arguments="{option:option}">Edit</f:link.action>
			<f:link.action action="delete" controller="Option" arguments="{option:option}">Delete</f:link.action>
			</f:then>
			<f:else></f:else>
      	</f:if>
		<f:for each="{project.assignments}" as="assignment">
			<f:if condition="{assignment.user.uid} == <bvs:GetUserId/>">
				<f:then>
					<f:if condition="{assignment.role.name} == 'admin'">
						<f:then>
							<f:link.action action="edit" arguments="{option:option}"><f:translate key="tx_bcvoting_edit" /></f:link.action>
							<f:link.action action="delete" arguments="{option:option}"><f:translate key="tx_bcvoting_delete" /></f:link.action>
						</f:then>
					</f:if>
				</f:then>
			</f:if>
		</f:for>
      	<!-- f:if condition="<bvs:GetUserId/> > 0"><f:then><f:translate key="tx_bcvoting_vote" /></f:then></f:if -->

      </td>
    </tr>    
  </f:for>
    <tr>
      <td>
		<f:for each="{project.assignments}" as="assignment">
			<f:if condition="{assignment.user.uid} == <bvs:GetUserId/>">
				<f:then>
					<f:if condition="{assignment.role.name} == 'admin'">
						<f:then>
							<f:then><f:link.action action="new" controller="Option" arguments="{project : project}">New Option</f:link.action></f:then>
						</f:then>
					</f:if>
				</f:then>
			</f:if>
		</f:for>
	 </td>
      <td>
    
      </td>
      <td>&nbsp;</td>
    </tr>
</table>
<f:for each="{project.assignments}" as="assignment">
	<f:if condition="{assignment.user.uid} == <bvs:GetUserId/>">
		<f:then>
			<f:if condition="{assignment.role.name} == 'admin'">
				<f:then>
					<f:then><f:link.action action="ballot" controller="Option">Generate ballots for clients</f:link.action></f:then>
				</f:then>
			</f:if>
		</f:then>
	</f:if>
</f:for>  
</f:section>
